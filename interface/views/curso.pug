extends layout

block content
    .modal(id="display")

    .w3-container
        .w3-container.w3-content
        .w3-card-4.w3-margin
            header.w3-container.w3-indigo
                h1 Informação do Curso
                
            .w3-margin
                p
                    b Nome: 
                    | #{curso.nome}
                p 
                    b Descrição: 
                    | #{curso.descricao}
                p 
                    b Professores: 
                    ul
                    each prof in curso.professores 
                        li.w3-margin-left= prof
                p 
                    b Nº de Alunos: 
                    | #{curso.alunos.length}
                p
                    b Visibilidade: 
                    if curso.visibilidade == 'privado'
                        i.w3-xlarge.fa.fa-lock
                    else
                        i.w3-xlarge.fa.fa-unlock 
            if !permission
                // button to join course
                form(action=`/cursos/${curso._id}/entrar`, method='POST')
                    input.w3-button.w3-indigo.w3-margin(type='submit', value='Entar no Curso')
    if permission
        .w3-container.w3-half
            .w3-container.w3-content
            .w3-card-4.w3-margin
                header.w3-container.w3-indigo
                    h1 Posts do Curso

                each post in curso.posts       
                    .w3-container
                        .w3-panel.w3-light-grey.w3-bottombar.w3-border-grey.w3-border.w3-display-container 
                            p 
                                b Título: 
                                | #{post.title}
                            p 
                                b Descrição: 
                                | #{post.description}
                            p 
                                b Publicado por: 
                                | #{post.publishedBy}

        .w3-container.w3-half
            .w3-container.w3-content
            .w3-card-4.w3-margin
                header.w3-container.w3-indigo
                    h1(style="width:50%;display: inline")="Recursos do Curso"
                        if level == "professor"
                            span
                                a.w3-circle.w3-button.w3-margin(href=`/cursos/${curso._id}/files/upload`)
                                    i.fa.fa-plus
                                

                each meta in metas       
                    .w3-container
                        .w3-panel.w3-light-grey.w3-bottombar.w3-border-grey.w3-border.w3-display-container 
                            p 
                                b Título: 
                                | #{meta.title}
                            p 
                                b Subtítulo: 
                                | #{meta.subtitle}
                            p 
                                b Publicado por: 
                                | #{meta.uploadBy}
                            if level == "aluno"
                              span 
                                  b Rating: 
                                  - var met = meta.rated ? 'edit' : ''
                                  form(action=`/cursos/${curso._id}/files/${meta._id}/rate/${met}`, method="POST", style="display: inline")
                                      select.w3-select(name='rating',onchange=`this.form.submit()`, style="width: 50px", defaultValue="")
                                          option(value="" selected)
                                          each number in [1,2,3,4,5]
                                            - console.log(meta.rating)
                                            if meta.rating == number
                                              option(value=number, selected) #{number}
                                            else
                                              option(value=number) #{number}
                            if average
                              p 
                                  b Média de Rating: 
                                  | #{average} 
                            // Open button
                            button.w3-margin-top.w3-button.w3-indigo.w3-display-bottomright(onclick=`showFile('${meta.id}','${meta.mimetype}')`) Open
                             
    
                                







